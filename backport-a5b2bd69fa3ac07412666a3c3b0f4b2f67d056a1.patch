From a5b2bd69fa3ac07412666a3c3b0f4b2f67d056a1 Mon Sep 17 00:00:00 2001
From: David Neto <dneto@google.com>
Date: Tue, 6 May 2025 08:50:37 -0400
Subject: [PATCH] Ci legacy asciidoc (#477)

Add a CI check for legacy asciidoc in json files
---
 .github/workflows/presubmit.yml | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/.github/workflows/presubmit.yml b/.github/workflows/presubmit.yml
index d7958ca..2479315 100644
--- a/.github/workflows/presubmit.yml
+++ b/.github/workflows/presubmit.yml
@@ -38,6 +38,16 @@ jobs:
           ./bin/makeHeaders
       - name: Check generated headers
         run: git diff --exit-code
+      - name: Check for legacy asciidoc in JSON
+        if: matrix.os == 'ubuntu-latest'
+        run: |
+          grep \"\'".*"\'\" include/spirv/unified1/*.json >build/bad-asciidoc.txt || true
+          if [ 0 -lt $(cat build/bad-asciidoc.txt | wc -l) ]; then
+            echo "Legacy asciidoc italics detected, like \"'foo'\". Text formating aren't used anymore. Please use \"foo\" instead."
+            head -10 build/bad-asciidoc.txt
+            exit 1
+          fi
+
 
   test_cmake_min_required:
     runs-on: ubuntu-latest
-- 
2.49.0

